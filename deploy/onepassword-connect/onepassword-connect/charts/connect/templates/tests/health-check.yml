---
# Source: onepassword-connect/charts/connect/templates/tests/health-check.yml
apiVersion: v1
kind: Pod
metadata:
  name: "onepassword-connect-health-check"
  namespace: onepassword-connect
  labels:
    helm.sh/chart: connect-2.3.0
    app.kubernetes.io/name: connect
    app.kubernetes.io/instance: onepassword-connect
    app.kubernetes.io/version: "1.8.1"
    app.kubernetes.io/managed-by: Helm
  annotations:
    helm.sh/hook: test
    helm.sh/hook-weight: "1"
spec:
  restartPolicy: Never
  securityContext:
    fsGroup: 65532
    runAsGroup: 65532
    runAsNonRoot: true
    runAsUser: 65532
    seccompProfile:
      type: RuntimeDefault
  containers:
    - name: curl
      image: curlimages/curl:latest

      command: ["curl", "http://onepassword-connect:8080/health"]
      securityContext:
        allowPrivilegeEscalation: false
        capabilities:
          drop:
          - ALL
        readOnlyRootFilesystem: true
